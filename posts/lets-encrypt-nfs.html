<!-- subject: Let’s Encrypt NearlyFreeSpeech -->
<!-- date: 2016-05-31 22:22:22 -->
<!-- tags: lets encrypt, tls, nearlyfreespeech -->
<!-- categories: Articles, English, Techblog, Files -->

<p>To make <a href=/2016/tls-is-a-yes/>TLS the default</a>, I needed
to automate certificate renewal process.  In doing so, I’ve came up
with a script which may be handy to all
<a href="https://www.nearlyfreespeech.net/">NearlyFreeSpeech</a>
hosting provider clients.

<p><a href="https://github.com/mina86/lets-encrypt-nfs">Let’s Encrypt
NearlyFreeSpeech</a> uses Lukas
Schauer’s <a href="https://github.com/lukas2511/letsencrypt.sh">letsencrypt.sh</a>
<a href="https://en.wikipedia.org/wiki/Automated_Certificate_Management_Environment">ACME</a>
client and requires <em>no</em> configuration.  To start using it,
first get the code onto your <em>local</em> machine by running:

<pre>cd <i>${some_directory?}</i>
git clone https://github.com/mina86/lets-encrypt-nfs</pre>

<p><code><i>${some_directory?}</i></code> is an arbitrary directory to
put the code into.  It may be <code>$HOME</code> for example.  Once
the package is installed, the following command is sufficient to
install certificates on an NFS-hosted site:

<pre><i>${some_directory?}</i>/lets-encrypt-nfs/pull-and-run \
    ./remote --setup \
    <i>${username?}_${sitename?}</i>@ssh.phx.nearlyfreespeech.net</pre>

<p>It will log into your NFS site, fetch all necessary repositories
from GitHub, run Let’s Encrypt client, enable TLS on the site and
finally describe how to set up a scheduled task which will renew the
certificate automatically.  Simply follow the instruction and you
should be all set.

<!-- EXCERPT -->

<p><strong>N.B.</strong>: Enabling encryption for the first time turns
HTTP→HTTPS redirection for the site on.  This can be disabled in NFS
site settings under Canonical URL option.


<h3>Running on NFS host</h3>

<p>The script doesn’t need to be run from local machine; it can be
executed on NFS host directly.  Getting the code on the machine is
analogous to its local installation, i.e.:

<pre>git clone https://github.com/mina86/lets-encrypt-nfs \
          /home/private/lets-encrypt-nfs</pre>

<p>Once cloning is done, getting certificates is done with the
following command:

<pre>/home/private/lets-encrypt-nfs/pull-and-run ./renew</pre>


<h3>Per-Alias Site Root</h3>

<p>At the moment, per-alias site roots are not supported by the
  script.
